<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>811 Laroe Plant Guide</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="pinterest" content="nopin" />

    {# The nested tabs #}
    <link rel="stylesheet" href="./tabs/style.css">

    {# Bootstrap css #}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    {# PhotoSwipe (the slideshow)) #}
    <link rel="stylesheet" href="./photoswipe/dist/photoswipe.css">
    <link rel="stylesheet" href="./photoswipe/photoswipe-dynamic-caption-plugin.css">

    <link rel="stylesheet" href="plantbook.css">
  </head>
  <body>
    <div class="container">
    <h1>811 Laroe Plant Guide</h1>
    </div>

  {% macro plantEntry(p) -%}
    <div style="margin-bottom:30px;">
      <div class="row" style="border: solid #cccccc 1px; padding:10px; background:#dddddd;">
        <div class="column plant_listing col-sm-8">
        <div class="scientific_name">{{p.scientific_name}}</div>
        <h2 class="common_name">{{p.common_name}}</h2>
        </div>
        <div class="col-sm-4" style=" text-align:right;">
        {% if p.nativity %}
        <span class="badge badge-pill {{nativity_labels[p.nativity]}}">{{nativity_values[p.nativity]}}</span>
        {% endif %}
        </div>
      </div>
      <div class="row" style="border: solid #cccccc 1px; padding:20px; background:#f8f8f8">
      {% for photo in p.photo_records %}
        <div class="col-sm-2  pswp-gallery__item">
          <a
                href="images/{{photo.filename}}"
                data-pswp-width="{{photo.width}}"
                data-pswp-height="{{photo.height}}"
                target="_blank">
            <img src="thumbs/{{photo.filename}}" alt="{{p.scientific_name}}" height="{{photo.thumbnail_height}}" width="{{photo.thumbnail_width}}"
               style="width: 150px; height: 150px; object-fit: cover;">
          </a>
          <div class="pswp-caption-content">
	    <div class="plant_caption">
            <p>{{plant_types[p.plant_type]}}</p>
            <p class="scientific_name">{{p.scientific_name}}</p>
            <p class="common_name">{{p.common_name}}</p>
            <p>{{photo.date}}</p>
            <dl>
              <dt>Locations</dt>
              {% for l in p.locations %}
              <dd>{{locations[l]}}</dd>
              {% endfor %}
            </dl>
            </div>
          </div>
        </div>
      {% endfor %}
      </div>
      {% if p.snippet %}
      <div class="row" style="border: solid #cccccc 1px; padding:10px; background:#f8f8f8;">
        <div class="column plant_listing">{{p.snippet}}</div>
      </div>
      {% endif %}
    </div>
  {%- endmacro %}

  {% macro plantList(key, plants) -%}
    <div class="container" id="gallery_{{key}}">
    {% for p in plants %}
      {{ plantEntry(p) }}
    {% endfor %}
    </div>
  {%- endmacro %}


    <div class="tab container">
      <div class="tab__list">
        <div class="tab__item">All Plants</div>
        <div class="tab__item">By Location</div>
        <div class="tab__item">By Type</div>
      </div>
      <div class="tab__content">
        <div class="tab__content-item">{{ plantList("all", plants) }}</div>
        <div class="tab__content-item tab">
          <div class="tab__list">
            {% for location in locations %}
              <div class="tab__item">{{locations[location]}}</div>
            {% endfor %}
          </div>
          <div class="tab__content">
            {% for location in locations %}
            <div class="tab__content-item">
              {{ plantList(location, plant_collection.get_plants_by_location(location)) }}
            </div>
            {% endfor %}
          </div>
        </div>
         <div class="tab__content-item tab">
          <div class="tab__list">
            {% for plant_type in plant_types %}
              <div class="tab__item">{{plant_types[plant_type]}}</div>
            {% endfor %}
          </div>
          <div class="tab__content">
            {% for plant_type in plant_types %}
            <div class="tab__content-item">
            {{ plantList(plant_type, plant_collection.get_plants_by_type(plant_type)) }}
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>




    <script type="module">
      import PhotoSwipeLightbox from './photoswipe/dist/photoswipe-lightbox.esm.js';
      import PhotoSwipeDynamicCaption from './photoswipe/photoswipe-dynamic-caption-plugin.esm.js';

      const smallScreenPadding = {
        top: 0, bottom: 0, left: 0, right: 0
      };
      const largeScreenPadding = {
        top: 0, bottom: 0, left: 0, right: 30
      };

      function createLightbox(tag) {
        const lightbox = new PhotoSwipeLightbox({
          showHideAnimationType: 'fade',
          gallerySelector: '#gallery_' + tag,
          childSelector: '.pswp-gallery__item',
          bgOpacity: 0.9,
          
          // optionally adjust viewport
          paddingFn: (viewportSize) => {
            return viewportSize.x < 700 ? smallScreenPadding : largeScreenPadding
          },
          pswpModule: () => import('./photoswipe/dist/photoswipe.esm.js')
        });

        const captionPlugin = new PhotoSwipeDynamicCaption(lightbox, {
          mobileLayoutBreakpoint: 700,
          type: 'aside',
          mobileCaptionOverlapRatio: 1
        });

        lightbox.init();
      }
      createLightbox('all');
      {% for plant_type in plant_types %}
        createLightbox('{{ plant_type }}')
      {% endfor %}
      {% for location in locations %}
        createLightbox('{{ location }}')
      {% endfor %}

    </script>

    <script  src="./tabs/script.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

  </body>
</html>
