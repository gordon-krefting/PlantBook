<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>811 Laroe Plant Guide</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="pinterest" content="nopin" />
    <link rel="stylesheet" href="./tabs/style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="plantbook.css">
    <link rel="stylesheet" href="./photoswipe/dist/photoswipe.css">
    <link rel="stylesheet" href="./photoswipe/photoswipe-dynamic-caption-plugin.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <style>
      body {
        margin: 0;
        padding: 0;
        font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;
        font-size: 14px;
        line-height: 20px;
        background: #fff;
      }
      .pswp-gallery__item {
        margin: 0 4px 4px 0;
      }
      .pswp-gallery__item img {
        display: block;
      }
      .pswp-gallery {
        max-width: 650px;
        padding: 0 50px 50px;
        background: #eee;
        position: relative;
        display: flex;
        flex-wrap: wrap;
      }
      .pswp__dynamic-caption {
        color: #fff;
        width: 100%;
      }
      .pswp__dynamic-caption a {
        color: #fff;
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <div class="container">
    <h1>811 Laroe Plant Guide</h1>
    </div>

  {% macro plantEntry(p) -%}
      <div class="row" style="border: solid #cccccc 1px; padding:10px; background:#dddddd;">
        <div class="column plant_listing">
        <p class="scientific_name">{{p.scientific_name}}</p>
        <p class="common_name">{{p.common_name}}</p>
        </div>
      </div>
      <div class="row" style="border: solid #cccccc 1px; padding:20px; margin-bottom:30px; background:#eeeeee">
      {% for photo in p.photo_records %}
        <div class="col-sm-2  pswp-gallery__item">
          <a
                href="images/{{photo.filename}}"
                data-pswp-width="{{photo.width}}"
                data-pswp-height="{{photo.height}}"
                target="_blank">
            <img src="thumbs/{{photo.filename}}" alt="{{p.scientific_name}}" height="{{photo.thumbnail_height}}" width="{{photo.thumbnail_width}}"
               style="width: 150px; height: 150px; object-fit: cover;">
          </a>
          <div class="pswp-caption-content">
	    <div class="plant_caption">
	    <p>{{plant_types[p.plant_type]}}</p>
            <p class="scientific_name">{{p.scientific_name}}</p>
            <p class="common_name">{{p.common_name}}</p>
            <p>{{photo.date}}</p>
            <dl>
              <dt>Locations</dt>
              {% for l in p.locations %}
              <dd>{{locations[l]}}</dd>
              {% endfor %}
            </dl>
            {% if p.snippet %}<p>{{p.snippet}}</p>{% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
      </div>
  {%- endmacro %}

  {% macro plantList(key, plants) -%}
    <div class="container" id="gallery_{{key}}">
    {% for p in plants %}
      {{ plantEntry(p) }}
    {% endfor %}
    </div>
  {%- endmacro %}


    <div class="tab container">
      <div class="tab__list">
        <div class="tab__item">All Plants</div>
        <div class="tab__item">By Location</div>
        <div class="tab__item">By Type</div>
      </div>
      <div class="tab__content">
        <div class="tab__content-item">{{ plantList("all", plants) }}</div>
        <div class="tab__content-item tab">
          <div class="tab__list">
            {% for location in locations %}
              <div class="tab__item">{{locations[location]}}</div>
            {% endfor %}
          </div>
          <div class="tab__content">
            {% for location in locations %}
            <div class="tab__content-item">
              {{ plantList(location, plant_collection.get_plants_by_location(location)) }}
            </div>
            {% endfor %}
          </div>
        </div>
         <div class="tab__content-item tab">
          <div class="tab__list">
            {% for plant_type in plant_types %}
              <div class="tab__item">{{plant_types[plant_type]}}</div>
            {% endfor %}
          </div>
          <div class="tab__content">
            {% for plant_type in plant_types %}
            <div class="tab__content-item">
            {{ plantList(plant_type, plant_collection.get_plants_by_type(plant_type)) }}
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>




    <script type="module">
      import PhotoSwipeLightbox from '../photoswipe/dist/photoswipe-lightbox.esm.js';
      import PhotoSwipeDynamicCaption from './photoswipe/photoswipe-dynamic-caption-plugin.esm.js';

      const smallScreenPadding = {
        top: 0, bottom: 0, left: 0, right: 0
      };
      const largeScreenPadding = {
        top: 0, bottom: 0, left: 0, right: 30
      };

      function createLightbox(tag) {
        const lightbox = new PhotoSwipeLightbox({
          showHideAnimationType: 'fade',
          gallerySelector: '#gallery_' + tag,
          childSelector: '.pswp-gallery__item',
          bgOpacity: 0.9,
          
          // optionally adjust viewport
          paddingFn: (viewportSize) => {
            return viewportSize.x < 700 ? smallScreenPadding : largeScreenPadding
          },
          pswpModule: () => import('./photoswipe/dist/photoswipe.esm.js')
        });

        const captionPlugin = new PhotoSwipeDynamicCaption(lightbox, {
          mobileLayoutBreakpoint: 700,
          type: 'aside',
          mobileCaptionOverlapRatio: 1
        });

        lightbox.init();
      }
      createLightbox('all');
      {% for plant_type in plant_types %}
        createLightbox('{{ plant_type }}')
      {% endfor %}
      {% for location in locations %}
        createLightbox('{{ location }}')
      {% endfor %}

    </script>
    <script  src="./tabs/script.js"></script>

  </body>
</html>
